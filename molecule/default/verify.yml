# SPDX-FileCopyrightText: 2020 Helmholtz Centre for Environmental Research (UFZ)
# SPDX-FileCopyrightText: 2020 Helmholtz-Zentrum Dresden - Rossendorf (HZDR)
#
# SPDX-License-Identifier: Apache-2.0

---
- name: Verify
  hosts: all
  tasks:
    - name: Gather package facts
      package_facts:
        manager: auto

    - name: Assert that Gitlab-Runner is installed
      assert:
        that:
          - "'gitlab-runner' in ansible_facts.packages"

    - name: Assert that installed GitLab version is equal to the desired one
      assert:
        that:
          - "ansible_facts.packages['gitlab-runner'][0].version == gitlab_runner_version"
      when:
        - gitlab_runner_version is defined
